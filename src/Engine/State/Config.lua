local addon, ns = ...

-- ========================================================================
-- 状态系统配置中心
-- ========================================================================
-- 集中管理所有常量和配置，便于调整和维护

-- ========================================================================
-- 时间和冷却配置
-- ========================================================================

-- 全局冷却时间（GCD）阈值：持续时间 <= 1.5 秒视为 GCD，而非真实技能冷却
local GCD_THRESHOLD = 1.5

-- ========================================================================
-- 光环系统配置
-- ========================================================================

-- 最大光环槽位数：WoW 3.3.5 每个单位最多显示 40 个光环
local MAX_AURA_SLOTS = 40

-- ========================================================================
-- 资源类型映射（WoW 3.3.5 API）
-- ========================================================================

-- UnitPower/UnitPowerMax 的 powerType 参数映射
local POWER_TYPES = {
    mana = 0,           -- 法力（法系职业）
    rage = 1,           -- 怒气（战士）
    focus = 2,          -- 集中（猎人宠物，WotLK 中猎人还用法力）
    energy = 3,         -- 能量（盗贼、德鲁伊猫形态）
    happiness = 4,      -- 快乐值（猎人宠物）
    runes = 5,          -- 符文（死亡骑士，特殊处理）
    runic_power = 6,    -- 符文能量（死亡骑士）
    -- 注意：圣能（holy_power）在 WotLK 3.3.5 原版不存在，泰坦服可能支持 Type 9
}

-- ========================================================================
-- 资源上限配置
-- ========================================================================

-- 资源默认上限（用于回复计算时的封顶检测）
local RESOURCE_CAPS = {
    energy = 100,       -- 能量上限（盗贼/猫德）
    rage = 100,         -- 怒气上限（战士/熊德）
    runic_power = 100,  -- 符文能量上限（死亡骑士）
    -- 法力上限动态获取，不在此配置
}

-- ========================================================================
-- 资源回复速率配置
-- ========================================================================

-- 基础资源回复速率（每秒）
local RESOURCE_REGEN_RATES = {
    energy = 10,        -- 能量基础回复：10/秒（受急速影响）
    runic_power = 10,   -- 符文能量基础回复：10/秒（平坦回复）
    rage_decay = 1,     -- 怒气脱战衰减：-1/秒
}

-- ========================================================================
-- 延迟补偿配置
-- ========================================================================

-- 施法延迟补偿窗口：施法后 N 秒内假定 Debuff 已存在（处理网络延迟）
local SPELL_LATENCY_WINDOW = 1.0

-- ========================================================================
-- 导出配置
-- ========================================================================

ns.StateConfig = {
    -- 时间和冷却
    GCD_THRESHOLD = GCD_THRESHOLD,
    
    -- 光环系统
    MAX_AURA_SLOTS = MAX_AURA_SLOTS,
    
    -- 资源系统
    POWER_TYPES = POWER_TYPES,
    RESOURCE_CAPS = RESOURCE_CAPS,
    RESOURCE_REGEN_RATES = RESOURCE_REGEN_RATES,
    
    -- 延迟补偿
    SPELL_LATENCY_WINDOW = SPELL_LATENCY_WINDOW,
}
